env:
  global:
    - CC_TEST_REPORTER_ID=3d08e1d89788b71e86049ab5a33c842521c0d8188528e4d51b614575f79f2cd7

language: ruby
rvm: 2.4.2
cache: bundler

# Travis CI clones repositories to a depth of 50 commits, which is only really
# useful if you are performing git operations.
# https://docs.travis-ci.com/user/customizing-the-build/#Git-Clone-Depth
git:
  depth: 3

before_install:
  - export TZ=UTC

before_script:
  # Setup to support the CodeClimate test coverage submission
  # As per CodeClimate's documentation, they suggest only running
  # ./cc-test-reporter commands on travis-ci push builds only. Hence we wrap all
  # the codeclimate test coverage related commands in a check that tests if we
  # are in a pull request or not.
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter; fi
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then chmod +x ./cc-test-reporter; fi
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then ./cc-test-reporter before-build; fi
  # Run rubocop. It's installed as a dependency (hence no install step) as this
  # allows projects to control the version they are using (rather than getting)
  # surprise build failures.
  - bundle exec rubocop

after_script:
  - if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT; fi

deploy:
  provider: rubygems
  gem: os_map_ref
  on:
    tags: true
  api_key:
    secure: "v/ZYjyakCM5T3wtbdMBcG4OXgoVJoZCQ+Bapc6PImcpEN2UVtr2OSPjRsD6PbEbjzaiy/RAIURDMql2NoP3lUxUeVWAGsNgZvvjNzt3Gd5P47wC4k1peMY4RBuh9yyTn8wtsg3yUEe0V7cmB7SVOL08PmOWU5OcfAAZOTJWaKHsFV1ClxSDMeBbhwwGHRj4xP/+Alx08t62VpC1SrHkJvTM0oAlm+AP3Y/8a4Hcu0VhgPjof4nCeZHgqrEYthtC77Uk/EJTlW5FzEVXIbgSmWVq0OTdVXinxPrI1MizqSsZx5o/CbBCm8zzsZBTTVqMtWBae/AsQar8wMk1Cq4IEu1iOh2ra312RSClqqjsiVz80iRc+lCEpTz+co2V/qU4lg8rWeNg2j1HJLr8GTjeaOvqmjJT2A5rZsSngHty3uddkZwjvgBO/zOjp3BPpP+PaowWviYhDmBxDLyVnwSs2KG9otBucmxPAdr9WUE+jqSkOVjYdTAG3eyKaYkTX5QjDieYcBKhyjgkOXtawN8z+qJQo6LH7+TDRoMMZ0LIFKr6nqV77E2xxREEyjfND3MM73nJKTYWjP1/zBCHmUNWMcGRLTWoO2mXVrr0N7+SNAiNpO429jPj5ZifW7Opi7ptiLwCAdCJI0gQe9A7DMW5GAloXLsUjkk3YmXRssUW2KF8="
